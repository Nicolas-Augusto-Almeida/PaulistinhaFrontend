<div class="container mt-3">
  <button
    class="btn btn-primary d-flex align-items-center gap-2 mb-3"
    (click)="carregarLogs()"
  >
    <i class="bi bi-arrow-clockwise"></i> Atualizar Lista
  </button>

  <div class="mb-3">
    <label for="filtro" class="form-label fw-bold">Pesquisar Histórico</label>
    <input
      type="text"
      class="form-control"
      id="filtro"
      placeholder="Digite o nome do produto ou funcionário..."
      (input)="filtrar($event)"
    />
  </div>

  <h2
    class="mb-4 text-danger fw-bold border-bottom border-3 border-danger pb-2"
  >
    Histórico de Auditoria
  </h2>

  <div
    class="table-responsive border rounded shadow-sm"
    style="max-height: 500px; overflow-y: auto"
  >
    <table
      class="table table-striped-columns table-hover align-middle text-nowrap mb-0"
    >
      <thead class="table-light sticky-top" style="z-index: 1">
        <tr>
          <th scope="col">Data/Hora</th>
          <th scope="col" class="text-center">Ação</th>
          <th scope="col">Produto</th>
          <th scope="col" class="text-center">Qtd.</th>
          <th scope="col">Funcionário</th>
          <th scope="col">Detalhes</th>
        </tr>
      </thead>

      <tbody>
        @for (log of logsFiltrados; track log.id) {
        <tr>
          <td>{{ log.dataHora | date : "dd/MM/yyyy HH:mm" }}</td>

          <td class="text-center">
            <span
              class="badge rounded-pill"
              [ngClass]="getBadgeClass(log.acao)"
            >
              {{ formatarAcao(log.acao) }}
            </span>
          </td>

          <td>{{ log.produtoNome }}</td>

          <td class="text-center fw-bold">{{ log.quantidadeAlterada }}</td>

          <td>
            <div class="d-flex flex-column">
              <span>{{ log.funcionarioNome }}</span>
              <small class="text-muted" style="font-size: 0.75rem">
                CPF: {{ log.funcionarioCpf }}
              </small>
            </div>
          </td>

          <td
            style="max-width: 250px"
            class="text-truncate"
            title="{{ log.descricao }}"
          >
            <small class="text-secondary">{{ log.descricao || "-" }}</small>
          </td>
        </tr>
        } @empty {
        <tr>
          <td colspan="6" class="text-center p-3 text-muted">
            Nenhum registro de auditoria encontrado.
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>
